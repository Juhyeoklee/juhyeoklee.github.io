---
title:  "[iOS] ì—¬ëŸ¬ê°€ì§€ TableView, CollectionView ì“°ê¸°"
excerpt: "AppJam ë¦¬í™í† ë§ - 01"

categories:
  - iOS
tags:
 - Refactoring
last_modified_at: 2020-01-27
---

ì•± ê°œë°œì„ í•˜ë©´ì„œ TableView(ì´í•˜ â€˜TVâ€™) ë˜ëŠ” CollectionView(ì´í•˜ â€˜CVâ€™)ë¥¼ ì“°ëŠ”ì¼ì´ êµ‰ì¥íˆ ë§ìŠµë‹ˆë‹¤. í•˜ë‚˜ì˜ í™”ë©´ ì•ˆì—ì„œë„ ì—¬ëŸ¬ê°€ì§€ë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆëŠ”ë°ìš”.

ì˜¤ëŠ˜ì€í•˜ë‚˜ì˜ ViewController(ì´í•˜ â€˜VCâ€™) ì•ˆì—ì„œ ë‘ê°œ ì´ìƒì˜ TV ë˜ëŠ” CV
ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì— ëŒ€í•´ ì•Œì•„ ë³´ê² ìŠµë‹ˆë‹¤.

ë³´í†µ TV, CV ë¥¼ ì‚¬ìš©í•  ë•Œ VC ì˜ Extensionìœ¼ë¡œ Delegate ì™€ DataSource ë¥¼ ì¶”ê°€í•˜ì—¬ í•¨ìˆ˜ ì˜¤ë²„ë¼ì´ë“œ í†µí•´ ì“°ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤.

```swift
//
//  ComponentProductVC.swift
//  CareDirection
//
//  Created by ì´ì£¼í˜ on 2019/12/26.
//  Copyright Â© 2019 SwiftHelloWorld. All rights reserved.
//
import UIKit

class ComponentProductVC: UIViewController {
    â€¦
}

extension ComponentProductVC: UITableViewDelegate{
    func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {
        â€¦        
    }
}

extension ComponentProductVC: UITableViewDataSource{
    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
        â€¦
    }
    
    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
        â€¦
    }
}
```

 ê·¼ë° ì—¬ëŸ¬ê°€ì§€ TVë¥¼ ì“°ëŠ” ê²½ìš° ê°ê°ì˜ ì‚¬ìš©ë°©ë²•ì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— ì²˜ë¦¬ë¥¼ ë‹¤ë¥´ê²Œ í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.
ì²˜ìŒ ì €ëŠ” ì´ëŸ¬í•œ ìƒí™©ì„ ë§ë‹¥ëœ¨ë ¸ì„ ë•Œ VC, Delegate, DataSourceë¥¼ ìƒì† ë°›ëŠ” ìƒˆë¡œìš´ í´ë˜ìŠ¤ë¥¼ ìƒì„±í•˜ì—¬ ê°ê° ìƒí™©ì— ë§ëŠ” í•¨ìˆ˜ ì˜¤ë²„ë¼ì´ë“œë¥¼ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.

```swift
// MARK: - ProductFunctionCVExtension
class ProductFunctionCVExtension : UIViewController, UICollectionViewDelegate, UICollectionViewDataSource, UICollectionViewDelegateFlowLayout{
    
    var data: [EfficacyName]?
    
    func collectionView(_ collectionView: UICollectionView, numberOfItemsInSection section: Int) -> Int {
        â€¦
    }
    
    func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -> UICollectionViewCell {
        â€¦
    }
    
    func collectionView(_ collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, sizeForItemAt indexPath: IndexPath) -> CGSize {
        â€¦
    }
}
```

ê·¸ í›„ í•„ìš”í•œ ë°ì´í„°ë¥¼ ìµìŠ¤í…ì…˜ í´ë˜ìŠ¤ì— ë„˜ê²¨ì¤€ í›„ delegate, dataSourceë¥¼ í•´ë‹¹ í´ë˜ìŠ¤ì— ìœ„ì„í•˜ì˜€ìŠµë‹ˆë‹¤.

```swift
class ProductDetailVC: UIViewController {
        
    var productFunctionCVExtension = ProductFunctionCVExtension()
    â€¦
 
    override func viewDidLoad() {
        â€¦
        initVar()
        â€¦
    }

    func initVar(){
        
        ProductTapService.shared.productDetailEfficacy(idx: productIdx!){ data in
            switch data {
            case .success(let data):
                let result = data as! [EfficacyName]
                self.productFunctionCVExtension.data = result
                self.productFunctionCV.delegate = self.productFunctionCVExtension
                self.productFunctionCV.dataSource = self.productFunctionCVExtension
                â€¦
            }            
        }
        â€¦
    }
}
```

ì´ë ‡ê²Œ ê°ê° ëª©ì ì— ë§ëŠ” TV,CVë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. 

í•˜ì§€ë§Œ ì´ë ‡ê²Œ êµ¬í˜„í•˜ë©´ì„œ ì œê°€ ìƒê°í•œ ë¬¸ì œì ì´ ìˆì—ˆìŠµë‹ˆë‹¤.(ë¬¼ë¡  ë¬¸ì œì ì´ ì•„ë‹ìˆ˜ë„ ìˆì§€ë§Œ..)

### ë¶ˆí•„ìš”í•œ UIViewControllerì˜ ìƒì†
ìƒˆë¡œìš´ í´ë˜ìŠ¤ë¥¼ ì‘ì„±í•˜ë©´ì„œ ì²˜ìŒì—ëŠ” Delegateì™€ DataSourceë§Œì„ ìƒì†ì‹œí‚¨ í´ë˜ìŠ¤ë¥¼ ì‘ì„±í•˜ë ¤ê³  í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ê³µí¬ì˜ ë¹¨ê°„ì¤„.. ì´ë–´ëŠ”ë°ìš”.
 
![](/assets/images/appjam-refactoring-post01/img01.png)

ë¬¸ì œì ì„ ê²€ìƒ‰í•´ë³´ë©´ ëŒ€ì¶© DelegateëŠ” NSObjectProtocolì˜ ìƒì†ì„ ë°›ê¸° ë•Œë¬¸ì— í•´ë‹¹ ë©”ì†Œë“œë¥¼ ì˜¤ë²„ë¼ì´ë“œ í•´ì¤˜ì•¼ í•œë‹¤ê³  í•©ë‹ˆë‹¤.

> í•´ê²°ë°©ë²• ë˜í•œ ë‚˜ì˜¤ëŠ”ë° NSObjectì˜ ìƒì†ìœ¼ë¡œ í•´ê²°í•  ìˆ˜ ìˆë‹¤ê³  í•©ë‹ˆë‹¤.  
> ì‚¬ì‹¤ ê²€ìƒ‰ë„ ì•ˆí•´ë³´ê³  ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ í•´ê²°í•œ ë‚˜ì˜ë¬¸ì œ ğŸ˜…  

ì €ëŠ” ì´ëŸ¬í•œ ë¬¸ì œë¥¼ ë¹ ë¥´ê²Œ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ ê°„ë‹¨í•˜ê²Œ UIViewControllerë¥¼ ìƒì†í•´ ì¤Œìœ¼ë¡œì¨ ë„˜ì–´ ê°”ìŠµë‹ˆë‹¤. ê¸°ì¡´ì˜ Extension ë¶€ë¶„ì„ êµ¬í˜„í–ˆì„ ë•Œ ê¸°ë³¸ì ìœ¼ë¡œ UIViewControllerë¥¼ ìƒì†ë°›ëŠ” í´ë˜ìŠ¤ì˜ Extesionìœ¼ë¡œ êµ¬í˜„í•´ ì£¼ì—ˆê¸° ë•Œë¬¸ì— ì´ëŸ¬í•œ ë°©ë²•ìœ¼ë¡œ ë„˜ì–´ ê°”ì—ˆìŠµë‹ˆë‹¤.
ê·¸ëŸ¬ë‚˜ ì´ëŠ” ë¶ˆí•„ìš”í•œ ìƒì†ì´ë¼ê³  ìƒê°ì´ ë“¤ì—ˆìŠµë‹ˆë‹¤. ì œê°€ í•„ìš”í•œê±´ TV, CV delegateì˜ êµ¬í˜„ ë¶€ë¶„ì¸ë° ë¶ˆí•„ìš”í•œ ê¸°ëŠ¥ì„ í¬í•¨í•œ UIViewControllerë¥¼ ëª¨ë“  í´ë˜ìŠ¤ì— ìƒì†ì‹œì¼œì£¼ì—ˆìœ¼ë‹ˆ ìƒë‹¹í•œ ë©”ëª¨ë¦¬ë¥¼ ì†Œëª¨ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

ë”°ë¼ì„œ ì €ëŠ” ì´ëŸ¬í•œ ë¬¸ì œì ì„ í•´ê²° ì‹œí‚¤ê³  ì¼ìƒì ì¸? êµ¬í˜„ ë°©ì‹ì„ ì±„íƒí•˜ì—¬ ë¦¬íŒ©í† ë§ í•˜ê¸°ë¡œ ê²°ì •í•˜ì˜€ìŠµë‹ˆë‹¤.

### í•´ê²° ë°©ë²•

í•´ê²°ë°©ë²•ì€ ì‚¬ì‹¤ ê¸°ì¡´ì— ê³„ì† êµ¬í˜„í•´ì™”ë˜ Delegate ë“±ë“±ì˜ í”„ë¡œí† ì½œ ë©”ì†Œë“œ ì•ˆì— ìˆì—ˆìŠµë‹ˆë‹¤. ë°”ë¡œ ì´ëŸ¬í•œ ë©”ì†Œë“œì˜ ì²«ë²ˆì§¸ ì¸ì ì…ë‹ˆë‹¤.

```swift
func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -> UICollectionViewCell {
        â€¦
    }
```

ì´ëŸ¬í•œ delegate ë©”ì†Œë“œë“¤ì˜ ëŒ€ë¶€ë¶„ì— ì²«ë²ˆì§¸ ì¸ìë¡œ êµ¬í˜„í•  ì»´í¬ë„ŒíŠ¸ë“¤ì´ ë“¤ì–´ì™€ ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì²«ë²ˆì§¸ ì¸ìëŠ” ë°”ë¡œ êµ¬í˜„í•  CVì˜ ë©¤ë²„ ë³€ìˆ˜ë¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•´ë‹¹ ë©”ì†Œë“œê°€ ë™ì‘í•  ë•Œ ë©”ì†Œë“œì˜ ì²«ë²ˆì§¸ ì¸ìë¥¼ í†µí•´ êµ¬í˜„ë  CVë¥¼ íŒë‹¨í•˜ì—¬ ë™ì‘ì´ ë©ë‹ˆë‹¤. 

ë”°ë¼ì„œ IBOutletìœ¼ë¡œ ì„ ì–¸í•œ CV,TV ì˜ ë³€ìˆ˜ë¡œ í•´ë‹¹ ë©”ì„œë“œë¥¼ ë¶„ê¸° ì²˜ë¦¬í•˜ì—¬ êµ¬í˜„í•´ ì¤„ ìˆ˜ ê°€ ìˆìŠµë‹ˆë‹¤.

```swift
// MARK:- CollectionView Extension
// MARK: CollectionViewDataSource Extension
extension ProductDetailVC: UICollectionViewDataSource{
    func collectionView(_ collectionView: UICollectionView, numberOfItemsInSection section: Int) -> Int {
        switch collectionView {
        case productFunctionCV:
            return productFunctionCVExtensionData?.count ?? 0
        case naverLowestPriceInfoCV:
            return naverLowestPriceInfoCVExtensionData?.count ?? 0
        default:
            return 0
        }
    }
    
    func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -> UICollectionViewCell {
        switch collectionView {
            case productFunctionCV:
                let cell = collectionView.dequeueReusableCell(withReuseIdentifier: "ProductFunctionCVCell", for: indexPath) as! ProductFunctionCVCell
                â€¦
                return cell
            case naverLowestPriceInfoCV:
                let cell = collectionView.dequeueReusableCell(withReuseIdentifier: "NaverLowestPriceInfoCVCell", for: indexPath) as! NaverLowestPriceInfoCVCell
                â€¦
                return cell
            default:
                return UICollectionViewCell()
        }
    }
}
``` 

ë³€ìˆ˜ë¡œ ë¶„ê¸°ì²˜ë¦¬ë¥¼ í•œ ë’¤ Cellì— ëŒ€í•œ ì²˜ë¦¬ë¥¼ í•˜ë©´ ë©ë‹ˆë‹¤.

#iOS/AppJam_íšŒê³ 
